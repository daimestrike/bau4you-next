# Руководство по функционалу портфолио компаний

## Что было реализовано

### 1. Отображение портфолио на странице компании

**Страница**: `/companies/[id]` (вкладка "Портфолио")

**Функционал**:
- Показывает первые 4 проекта из портфолио
- Кнопка "Просмотреть все (X)" для перехода к полному списку
- Кнопка "Добавить проект" только для владельца компании
- Улучшенные карточки проектов с:
  - Изображениями
  - Датами выполнения
  - Стоимостью проекта
  - Статусом (Завершен/В работе/Черновик)
  - Меткой "Рекомендуемый"

### 2. Полная страница портфолио

**Страница**: `/companies/[id]/portfolio`

**Функционал**:
- Отображает все проекты компании
- Динамический заголовок с названием компании
- Права доступа на основе владения:
  - **Владелец**: может добавлять, редактировать и удалять проекты
  - **Посетители**: только просмотр проектов

### 3. Права доступа и безопасность

**Проверки**:
- Автоматическое определение владельца компании
- Скрытие кнопок управления для не-владельцев
- Защита форм редактирования
- Проверка авторизации на странице добавления проекта

## Как использовать

### Для владельцев компаний:

1. **Добавление проекта**:
   - Перейдите на страницу своей компании
   - Откройте вкладку "Портфолио"
   - Нажмите "Добавить проект"
   - Заполните форму и сохраните

2. **Управление портфолио**:
   - Нажмите "Просмотреть все" для полного списка
   - Используйте кнопки "Редактировать" и "Удалить" на каждом проекте

### Для посетителей:

1. **Просмотр портфолио**:
   - Откройте страницу любой компании
   - Перейдите на вкладку "Портфолио"
   - Просматривайте проекты компании
   - Нажмите "Просмотреть все" для полного списка

## Технические детали

### Структура данных проекта:
```typescript
interface PortfolioItem {
  id: string
  company_id: string
  title: string
  description: string
  start_date: string
  end_date: string
  location: string
  category: string
  status: 'completed' | 'in_progress' | 'draft'
  featured: boolean
  images: string[]
  tags: string[]
  project_url: string
  client_name: string
  project_value: number
}
```

### Политики RLS:
```sql
CREATE POLICY "Allow all operations for authenticated users" ON company_portfolio 
FOR ALL USING (auth.uid() IS NOT NULL) WITH CHECK (auth.uid() IS NOT NULL);
```

### Компоненты:
- `src/app/companies/[id]/page.tsx` - основная страница компании
- `src/app/companies/[id]/portfolio/page.tsx` - полная страница портфолио
- `src/app/companies/[id]/portfolio/add/page.tsx` - добавление проекта

## Следующие шаги

1. **Выполните SQL** из файла `fix_portfolio_rls_simple.sql` в Supabase Dashboard
2. **Войдите в систему** как владелец компании
3. **Добавьте проекты** в портфолио
4. **Протестируйте** просмотр как владелец и как посетитель

## Возможные улучшения

- Добавление фильтрации проектов по категориям
- Поиск по проектам
- Сортировка проектов
- Галерея изображений для каждого проекта
- Экспорт портфолио в PDF
- Интеграция с социальными сетями 